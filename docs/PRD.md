# PRD (Product Requirements Document)
# 노마(Noma) AI 맞춤형 복지 내비게이터

---

## 1. 제품 개요

| 항목 | 내용 |
|------|------|
| **제품명** | 노마(Noma) - AI 맞춤형 복지 내비게이터 |
| **소유 기관** | 경상남도사회서비스원 |
| **목적** | 도민이 일상 언어로 복지 서비스를 검색하고 안내받을 수 있는 AI 상담 시스템 |
| **대상 사용자** | 일반 도민, 고령자, 정보 취약계층 |
| **플랫폼** | 모바일 웹 (반응형, 데스크톱 겸용) |
| **기술 스택** | Node.js/Express, Google Gemini 2.5 Flash, Edge TTS, TailwindCSS |

---

## 2. 문제 정의

### 2.1 현재 문제
- 복지 서비스 정보가 **행정 용어**로 작성되어, 일반 도민(특히 고령자)이 자신에게 해당하는 서비스를 찾기 어려움
- 기존 복지 포털은 **카테고리 탐색 방식**으로, 사용자가 자신의 상황을 어떤 카테고리에 매핑해야 하는지 알아야 함
- 고령자·장애인 등 정보 취약계층은 **텍스트 입력**이 어려워 접근성이 낮음

### 2.2 솔루션
- **자연어 대화형 검색**: "몸이 아파" → 긴급돌봄지원사업 자동 매칭
- **음성 입출력**: STT(음성→텍스트) + TTS(텍스트→음성)로 눈/손이 불편한 사용자도 이용 가능
- **경로형 안내**: 대상 확인 → 신청 방법 → 혜택 → 연락처를 단계별로 제시

---

## 3. 사용자 페르소나

### P1. 김순자 (72세, 독거 어르신)
- **환경**: 안드로이드 스마트폰, 자녀가 북마크 해둔 웹 주소로 접속
- **니즈**: 퇴원 후 집에서 돌봐줄 사람이 없는데 어디에 연락해야 하는지 모름
- **행동 특성**: 텍스트 입력 어려움, 음성 사용 선호, 전화번호를 바로 누르고 싶음
- **핵심 가치**: 전화번호 하나만 알면 됨

### P2. 박민수 (38세, 장애인 자녀 부모)
- **환경**: 아이폰, 검색으로 유입
- **니즈**: 장애인 보조기기 지원이 있다고 들었는데 신청 자격과 방법을 알고 싶음
- **행동 특성**: 텍스트 입력 능숙, 여러 서비스 비교하고 싶음
- **핵심 가치**: 정확한 자격 요건과 신청 절차

### P3. 이영희 (55세, 읍면동 복지담당)
- **환경**: 데스크톱, 민원인에게 서비스 안내 시 참고 자료로 활용
- **니즈**: 전체 서비스를 카테고리별로 빠르게 조회
- **행동 특성**: 전체 서비스 목록 브라우징, 서비스 상세정보 확인
- **핵심 가치**: 정확한 공식 정보

---

## 4. 핵심 기능 요구사항

### 4.1 AI 대화형 검색 (Must-Have)

| ID | 요구사항 | 상세 |
|----|---------|------|
| F-01 | 자연어 질의 | 일상 한국어로 복지 서비스 검색 가능 |
| F-02 | 의미 기반 매칭 (RAG) | 유의어 사전 + 어미 제거 + 복합어 분해로 행정 용어 매핑 |
| F-03 | Strict Grounding | 지식베이스에 근거한 답변만 제공, 허위 서비스 생성 금지 |
| F-04 | 넓게→좁혀가기 대화 | 첫 질문에 2~3개 서비스 추천 후 후속 질문으로 좁혀감 |
| F-05 | STT 오류 보정 | 음성 인식 오타를 복지 맥락에 맞게 자동 보정 |
| F-06 | 대화 컨텍스트 유지 | 최근 8개 메시지 기반 멀티턴 대화 지원 |

### 4.2 음성 인터페이스 (Must-Have)

| ID | 요구사항 | 상세 |
|----|---------|------|
| F-07 | 음성 입력 (STT) | Web Speech API, 한국어(ko-KR), 음성 종료 시 자동 전송 |
| F-08 | 음성 출력 (TTS) | Edge TTS (ko-KR-SunHiNeural), AI 응답 + 추천 서비스명 + 연락처 읽어주기 |
| F-09 | 플로팅 마이크 | 모바일 우하단 고정 버튼, 녹음/재생 상태 시각 피드백 |

### 4.3 서비스 카드 UI (Must-Have)

| ID | 요구사항 | 상세 |
|----|---------|------|
| F-10 | 단계별 경로(Stepper) 카드 | ① 대상 확인 → ② 신청 방법 → ③ 받는 혜택 → ④ 연락처 |
| F-11 | 펼침/접힘 인터랙션 | 첫 단계 자동 펼침, 나머지 탭으로 토글 |
| F-12 | 전화번호 자동 링크 | 연락처 내 전화번호 감지 → `tel:` 링크로 탭-투-콜 |
| F-13 | 서비스 북마크 | "내 서랍" 저장 기능 (LocalStorage, 동의 필수) |
| F-14 | 상담 신청 | 이름·전화번호 입력 → 담당 기관 이메일 전송 (시뮬레이션) |

### 4.4 전체 서비스 브라우징 (Should-Have)

| ID | 요구사항 | 상세 |
|----|---------|------|
| F-15 | 카테고리 탭 네비게이션 | 공공돌봄 / 민간지원 / 국공립시설 컬러별 탭 |
| F-16 | 서비스 상세 펼침 | 리스트 항목 클릭 시 상세정보 표시 |
| F-17 | 서비스 이용 경로 안내 | 상담→자격확인→인력배정→서비스제공 4단계 시각화 |

### 4.5 세션 관리 (Should-Have)

| ID | 요구사항 | 상세 |
|----|---------|------|
| F-18 | 대화 이력 보존 | SessionStorage, 5분 비활성 시 자동 만료 |
| F-19 | 내 서랍 영속 저장 | LocalStorage, 명시적 동의 후 저장 |
| F-20 | 인사/일상 대화 처리 | 인사·감사·작별에 자연스럽게 응대, 서비스 검색 안 함 |

---

## 5. 비기능 요구사항

| 항목 | 요구사항 |
|------|---------|
| **성능** | AI 응답 SSE 스트리밍 (체감 지연 최소화), TTS 2회 재시도 |
| **접근성** | 큰 터치 영역(60px 마이크 버튼), 고대비 색상, 쉬운 한국어 |
| **반응형** | 모바일 1열 / 태블릿·데스크톱 2열 그리드, 768px 브레이크포인트 |
| **개인정보** | PII 서버 미저장, 익명 북마크, 세션 자동 만료 |
| **가용성** | Gemini API 429 시 에러 메시지 + 대표전화 안내 폴백 |
| **보안** | CORS 허용, HTTPS 지원(cert/key 준비), 입력 검증 |

---

## 6. 지식베이스 구조

| 카테고리 | 서비스 수 | 예시 서비스 |
|---------|----------|-----------|
| **공공돌봄** | 약 10건 | 긴급돌봄지원, 종합재가센터, 통합돌봄지원센터, 노인맞춤돌봄, 응급안전안심서비스 |
| **민간지원** | 약 4건 | 사회복지시설 대체인력, 장기요양기관 컨설팅, 활동지원사 교육 |
| **국공립시설** | 약 3건 | 경상남도청어린이집, 보조기기센터, 피해장애인쉼터 |

---

## 7. 기술 아키텍처 요약

```
[사용자 브라우저]
     │
     ├── 음성 입력 ──→ Web Speech API (STT) ──→ 텍스트 변환
     │
     ├── 텍스트 입력 ──→ POST /api/chat ──→ [Express 서버]
     │                                        │
     │                                  ┌─────┴─────┐
     │                                  │ RAG 엔진  │
     │                                  │ 어미 제거  │
     │                                  │ 유의어 확장 │
     │                                  │ 스코어링   │
     │                                  └─────┬─────┘
     │                                        │
     │                                  ┌─────┴─────┐
     │                                  │ Gemini AI │
     │                                  │ 2.5 Flash │
     │                                  └─────┬─────┘
     │                                        │
     ├── SSE 스트림 ←──────────────────────────┘
     │
     ├── TTS 요청 ──→ POST /api/tts ──→ Edge TTS ──→ 음성 재생
     │
     └── 카드 렌더링 ──→ Stepper UI + tel: 링크
```

---

## 8. 성공 지표 (KPI)

| 지표 | 측정 방법 | 목표 |
|------|----------|------|
| RAG 매칭률 | 일상어 쿼리 대비 관련 서비스 매칭 비율 | 80% 이상 |
| 상담 전환율 | 카드 노출 대비 "상담 신청" 클릭 비율 | 15% 이상 |
| 음성 사용률 | 전체 검색 대비 음성 입력 비율 | 30% 이상 (모바일) |
| 이탈률 | "서비스를 찾을 수 없습니다" 응답 비율 | 20% 이하 |
| TTS 완청률 | 음성 응답 시작 대비 끝까지 들은 비율 | 60% 이상 |

---

## 9. 제약 사항 및 향후 로드맵

### 현재 제약
- Gemini 무료 티어: 분당 20회 요청 제한
- 이메일 발송: 콘솔 시뮬레이션 (실제 SMTP 미연동)
- 지식베이스: CSV 17건 (확장 필요)
- 인증 체계: 없음 (공개 서비스)

### 향후 로드맵
| 단계 | 내용 |
|------|------|
| Phase 2 | 실제 이메일/SMS 발송 연동, 서비스 50건+ 확장 |
| Phase 3 | Vector DB 전환 (임베딩 기반 시맨틱 검색) |
| Phase 4 | 사용자 인증 + 상담 이력 관리 대시보드 |
| Phase 5 | 다국어 지원 (영어, 중국어, 베트남어) |
